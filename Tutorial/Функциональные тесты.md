#develop/tree 

В функциональных тестах основное внимание уделяется бизнес-требованиям к приложению. Они проверяют только результат некоторого действия и не проверяют промежуточные состояния системы при выполнении этого действия.

Иногда возникает путаница между понятиями интеграционных и функциональных тестов, так как и те и другие требуют взаимодействия нескольких компонентов друг с другом. Разница в том, что интеграционный тест нужен просто чтобы убедиться, что вы можете отправлять запросы к базе данных, тогда как функциональный тест будет ожидать получения из базы данных определенного значения в соответствии с требованиями продукта.

Функциональные тесты — это почти то же самое, что и приемочные, однако есть одно существенное различие: они не требуют использования веб сервера для запуска своих сценариев. Другими словами, мы будем запускать наше приложение внутри тестов, имитируя запросы и ответы.

Говоря простыми словами, мы устанавливаем переменные $_REQUEST, $_GET и $_POST, затем выполняем скрипт внутри теста, получаем ответ и тестируем все это. Функциональное тестирование может быть лучшим решением, чем приемочное, потому как такие тесты не требуют использования веб-сервера и могут предложить более подробный отладочный вывод. К примеру, если ваш сайт выбросит исключение, оно будет напечатано в консоли.

```php
<?php

namespace Tests\Feature;

use App\Jobs\AddShow;
use App\Models\Genre;
use App\Models\Show;
use App\Models\User;
use Illuminate\Foundation\Testing\RefreshDatabase;
use Illuminate\Support\Facades\Queue;
use Laravel\Sanctum\Sanctum;
use Tests\TestCase;

class ShowsTest extends TestCase
{
    use RefreshDatabase;

    public function testGetShowsList()
    {
        $count = random_int(2, 10);
        Show::factory()->count($count)->hasAttached(Genre::factory())->create();

        $response = $this->getJson(route('shows.index'));

        $response->assertStatus(200);
        $response->assertJsonStructure(['data' => [], 'links' => [], 'total']);
        $response->assertJsonFragment(['total' => $count]);
    }
}
```

prev:[[Сиды и моки]] next:[[Виды тестов и тестовые данные]]
